Window Manager
******************

Komponenta pro Nette 2.0. Umožňuje správu oken (otevírání, zavírání, minimalizace...) .[perex]

|Verze | 1.0
|Download | [http://www.cherryboss.cz/WindowManager.rar]
|Demo | [http://www.cherryboss.php5.cz/]
|Forum thread | [http://forum.nette.org/cs/8969-window-manager-pro-nette-2-0]
|Autor | Michal "CherryBoss" Vyšinský
|Licence | LGPL
| Nette | 2.0 PHP 5.2 (s prefixy)

Co to umí
=========

- Možnost otevírat, zavírat a minimalizovat okna
- Podpora cache (buď podle IP nebo podle identity uživatele) - zapamatování stavu oken
- Použití např. jako widgety na web, dialogy atd. s možností zavření a minimalizování

Instalace
=========

Stažený archiv rozbalte do složky libs.
Do config.neon přidejte službu windowmanager:
/--
windowmanager:
        class: ChWindowManager
        arguments: [container: @container, [[
                #relative to app dir
                templatespath: /windows/templates/
                cachetype: IP
        ]]]
\--
Argumenty:
- templatespath – cesta k adresáři s šablonami oken (relativně k appDIR)
- cachetype – buď IP – cache je podle počítače, nebo username – cache je podle identity uživatele

Přidání okna
----------

Pro přidání okna vytvoříme jeho třídu + template (v cestě, kterou jsme zadali v config.neon)

Přiklad template (Demo.latte)
-----------------------------------
/--html
<div id="{$type}Window" style="
     top: {!$top};
     left: {!$left};
     ">

	<div>
		<p class="btitle">{$title}</p>
		{if $enable_minimize == true}
			<a href="?do=minimizeWindow&type={$type}">minimize window</a>
		{/if}
		<a href="?do=closeWindow&type={$type}">close window</a>
	</div>
	<hr class="box_separator" />
	<div class="box_content">
		Zde může být i nějaký text :)
	</div>
</div>
\--

Příklad třídy okna (Demo.php)
-----------------------------
/--php
<?php

class Demo extends NObject{

    public $top = "0px"; public $left = "0px"; //pozice
    public $width = "300px"; public $height = "400px"; //velikost okna - zatím nefunkční
    public $title = "Demo Window"; //titulek okna
    public $template_file = "Demo.latte"; //název template souboru
    public $type = "Demo"; //typ okna (používá se jako identifikátor v cache a session)
    public $enable_minimize = true; //okno může být minimalizované
}
\--

Do presenteru musíme přidat následující handle metody:
------------------------------------------------------
/--php
public function handleOpenWindow($type) {
	if(!isset($this->context->session->getSection("windowmanager")->windows[$type])) {
		$this->context->windowmanager->createWindow($type);
	}
	if(isset($this->context->session->getSection("windowmanager")->windows[$type]["state"])) {
		switch($this->context->session->getSection("windowmanager")->windows[$type]["state"]) {
			case 0: $this->context->windowmanager->restoreWindow($type); break;
			case 1: $this->context->windowmanager->maximizeWindow($type); break;
		}
	}
	$this->redirect("this");
}

public function handleDeleteWindows() {
	$this->context->windowmanager->deleteWindows();
	$this->redirect("this");
}

public function displayWindow($type) {
	$this->context->windowmanager->displayWindow($type, $this->presenter);
}

public function handleMinimizeWindow($type) {
	$this->context->windowmanager->minimizeWindow($type);
	$this->redirect("this");
}

public function handleCloseWindow($type) {
	$this->context->windowmanager->closeWindow($type);
	$this->redirect("this");
}

public function handleSaveWindows($obj_id, $top, $left, $width, $height) {
	$this->context->windowmanager->saveWindowsSession($obj_id, $top, $left, $width, $height);
}

public function handleMaximizeWindow($type) {
	$this->context->windowmanager->maximizeWindow($type);
	$this->redirect("this");
}
}
\--

Do šablony přidáme:
-------------------
/--html
{ifset $windows}
	{foreach $windows as $window}
		{if (isset($window["state"]) && $window["state"] == 2)}
			{$presenter->displayWindow($window["type"])}
		{/if}
	{/foreach}
{/ifset}
\--
Stavy oken jsou:
- 0 - zavřené
- 1 - minimalizované
- 2 - otevřené

Okna lze lehce zajaxovat. Pravá síla přijde s napojením na jQuery UI knihovnu, která nám umožní okny hýbat. Viz. [demo | http://www.cherryboss.php5.cz/]

{{tags: window manager, manažer oken, cherryboss}}

{{author: CherryBoss|4022}}
