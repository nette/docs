Ajaxové formuláře
*********************

Odesílání formulářů ajaxem s jQuery.

|Verze | 0.1
|Forum thread | http://forum.nette.org/cs/1300-neco-jako-nette-js-s-jquery
|Autor | Jan Marek
|Licence | MIT

Instalace
---------

Je potřeba zkopírovat tento javascriptový kód a nalinkovat ho do webu.
/--code js
jQuery.fn.extend({
        ajaxSubmit: function (callback) {
                var form;
                var sendValues = {};

                // odesláno na tlačítku
                if (this.is(":submit")) {
                        form = this.parents("form");
                        sendValues[this.attr("name")] = this.val() || "";

                // odesláno na formuláři
                } else if (this.is("form")) {
                        form = this;

                // neplatný element, nic nedělat
                } else {
                        return null;
                }

                // validace
                if (form.get(0).onsubmit && !form.get(0).onsubmit()) return;

                var values = form.serializeArray();

                for (var i = 0; i < values.length; i++) {
                        var name = values[i].name;

                        // multi
                        if (name in sendValues) {
                                var val = sendValues[name];

                                if (!(val instanceof Array)) {
                                        val = [val];
                                }

                                val.push(values[i].value);
                                sendValues[name] = val;
                        } else {
                                sendValues[name] = values[i].value;
                        }
                }

                // odeslat ajaxový požadavek
                return jQuery.ajax({
                        url: form.attr("action"),
                        data: sendValues,
                        type: form.attr("method") || "get",
			success: callback || null
                });
        }
});
\--

Pro správnou funkčnost s nette je vhodné použít plugin [Ajax s jQuery | addons:cs/jquery ajax].


Příklad použití
---------------

Odeslání formuláře:
/--code js
$("form").ajaxSubmit(/* [callback] */);
\--

Odeslání formuláře pomocí tlačítka:
/--code js
$("form .odesilaci-tlacitko").ajaxSubmit(/* [callback] */);
\--

Zajaxovatění všech formulářů a všech jejich tlačítek na stránce:

/--code js
// po načtení stránky
$(function () {
        // odeslání na formulářích
        $("form").submit(function () {
                $(this).ajaxSubmit();
                return false;
        });

        // odeslání pomocí tlačítek
        $("form :submit").click(function () {
                $(this).ajaxSubmit();
                return false;
        });
});
\--

Historie
========

{{author: Honza Marek|516}}
