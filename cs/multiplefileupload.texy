MultipleFileUpload
******************

.[perex]
MultipleFileUpload (zkráceně MFU) je doplněk pro Nette Framework, který vašim uživatelům umožní pohodlně, jednoduše a interaktivně odesílat hromady souborů. Komfort nabízí nejen uživateli, ale i programátorovi. Uživatel může na pár kliknutí odeslat celé fotoalbum a programátorovi stačí na implementaci tohoto doplňku pouhé 2 řádky kódu. Navíc navíc tento doplněk podporuje AJAX pro maximální rychlost a uživatelské pohodlí!

.[note]
Aktuálně do **12.3.2010** (odloženo kvůli výpadku serveru) potřebuje MFU vaši pomoc. V MFU proběhly velké změny a je potřeba tento doplněk řádně otestovat. Pokud se chcete dozvědět více, klikněte "zde":http://forum.nette.org/cs/viewtopic.php?pid=27668#p27668.


|Autor | Honza Kuchař
|Inspirováno | http://forum.nette.org/cs/viewtopic.php?pid=15098#p15098
|Licence | New BSD License
|Diskuse | http://forum.nette.org/cs/2386-addon-multiplefileupload-multiplefileupload-form-control
|Demo | http://multiplefileupload.projekty.mujserver.net/
|Stav | **Ve vývoji.** Návrhy jak by jste si představovali finální podobu, piště na fórum. Jsou přijímány návrh jak na implementaci, tak na vizuální podobu.
|Nette | viz závislosti


Instalace
---------

Zkopírujte následující soubory:
- app/MultipleFileUpload
- document_root/css/uploadify.css
- document_root/images/*
- document_root/js/*
- document_root/swf/*

do bootstrapu přidejte
/---code php
MultipleFileUpload::register();
\---

.[note]
Pokud používáte Nette 0.9.2 nebo nižší, čtěte zde: http://forum.nette.org/cs/2566-httpuploadedfile-bug-pri-safe-mode-nema-opravneni-pri-presunu-souboru . V Nette 0.9.3-RC je už tato "chyba" opravena. http://github.com/dg/nette/commit/f36e5f07e0df3580ebae8a3b26562f8ae53e84a1

A potom už můžete **začít Multiple File Uploader používat**.

Použití
-------
/---code php
$f = new AppForm($this,$name);

$f->addMultipleFileUpload("pokus1","Testík",20)
    ->addRule("MultipleFileUpload::validateFilled","Musíte odeslat alespoň jeden soubor!")
    ->addRule("MultipleFileUpload::validateFileSize","Soubory jsou dohromady moc veliké!",1024); // 1 KB
\---
.[note]
Do formuláře je přeba opravdu zadávat přímo callback, protože ZATÍM není podporována validace na straně klienta!

Jako value tohoto controlu dostanu pole ve kterém je každý soubor validní (prošel isOK()) a je instancí HttpUploadedFile. Všechny soubory co zůstanou v tempech po odeslání formuláře budou smazány.

Takto vypadá pole co dostanete ke zpracování:
/---code php
array(1) {
      0 => object(HttpUploadedFile) (5) {
         "name" private => string(15) "application.ini"
         "type" private => string(24) "application/octet-stream"
         "size" private => int(164)
         "tmpName" private => string(107) "xxx"
         "error" private => int(0)
      }
}
\---

Vzhled prvku můžete upravovat v šablonách `MultipleFileUpload-withJS.phtml` a `MultipleFileUpload-withoutJS.phtml`. Popřípadě zde můžete i měnit nastavení uploadify.

.[note]
Tento form control zatím není tread-safe, takže MUSÍTE používat uploadify s volbou `simUploadLimit: 1`.

Podpora v prohlížečích
----------------------

|----------------------------------------------------
| Prohlížeč       | Hodnocení          | Poznámka
|----------------------------------------------------
| Firefox 3.5     | <b> ***** </b> .<> | Bez výhrad
| Google Chrome 2 | <b> ***** </b> .<> | Bez výhrad
| Opera 10.0      | <b> ***** </b> .<> | Bez výhrad
| IE 8            | <b> ***   </b> .<> | Rychlost odesílání - mezi soubory z nějakých důvodů chvíli čeká

Závislosti
----------

- minimální verze Nette 0.9.1, 0.9.2 (nutnost přepsat "HttpUploadedFile::move()":http://forum.nette.org/cs/2566-httpuploadedfile-bug-pri-safe-mode-nema-opravneni-pri-presunu-souboru)
- **doporučená verze Nette 0.9.3**
- JavaScript: [jQuery | http://jquery.com/], [Uploadify | http://www.uploadify.com/], [swfobject.js | http://code.google.com/p/swfobject/], [livequery | http://plugins.jquery.com/project/livequery/], [upravený ajax-form driver | https://guest:@svn.mujserver.net:8443/svn/Nette_MultipleFileUpload/trunk/document_root/js/nette-ajax-form.js]
- originální `jquery.uploadify.js` nefunguje s Internet Explorerem, protože má v id objektu pomlčku. IE to interpretuje jako mínus. Proto jsem vydal upravenou verzi, kterou najdete na svn ve složce `trunk/document_root/js/`. (od rev. 19)
- originální `swfobject.js` nefunguje v Internet Exploreru, protože Internet Explorer má bug s flashem ve formuláři. Upravenou verzi tohoto souboru najdete na svn ve složce `trunk/document_root/js/`. (od rev. 20)

Demo
----
http://multiplefileupload.projekty.mujserver.net/

<iframe width="100%" height="750" frameborder="3" src="http://multiplefileupload.projekty.mujserver.net/"></iframe>

SVN
---
https://guest:@svn.mujserver.net:8443/svn/Nette_MultipleFileUpload/trunk/

{{author: Honza Kuchař|1018}}
