TabControl
**********

.[perex]
Komponenta pro přehlednější zobrazení sekcí. Taby jsou plně stylovatelné pomocí jQuery UI Themes. Plně podporuje chod s JavaScriptem a AJAXem pro maximální požitek z prohlížení webu, ale funguje shodně i bez JavaScriptu.

|Download z SVN | https://guest@svn.mujserver.net:8443/svn/TabControl/
|Demo | http://tabcontrol.projekty.mujserver.net/
|Autor | Jan Kuchař
|Licence | New BSD License

Ukázka
===============

[* example.jpg *]


Pro chod `TabControl`u je potřeba upravená verze [SnippetHelperu | http://forum.nette.org/cs/2233-snippet-a-jeho-druhy-parametr]. Pokud se vám příklad zacykluje, pokračujte [zde | http://forum.nette.org/cs/2301-dalsi-nekonecny-cyklus-canonicalize].

Použití
=======

TabControl vytvoříme nejlépe továrničkou na komponenty.

/---php
    function createComponentTabs($name){
        $tc = new TabControl($this,$name);
        $tc->mode = TabControl::MODE_LAZY;
        $tc->sortable = true;
        //$tc->jQueryTabsOptions = "{ fx: { height: 'toggle',opacity:'toggle',marginTop:'toggle',marginBottom:'toggle',paddingTop:'toggle',paddingBottom:'toggle'} }";
        //$tc->handlerComponent = $this; // Is automatic
	//$tc->loaderText="Načítám...";

        $t = $tc->addTab("datagrid");
            $t->header = "DataGrid";
            $t->contentFactory = array($this,"createTabDataGrid");
            $t->hasSnippets = true; // Potřeba nastavit u každého tabu, ve kterém budou snippety! Jinak nebude fungovat AJAX! Mástejnou funkci jako @ v šablonách

        $t = $tc->addTab("novy");
            $t->header = "Nový";
            $t->contentFactory = array($this,"createTabNovy");

        $t = $tc->addTab("edit");
            $t->header = "Editovat";
            $t->contentFactory = array($this,"createTabEdit");
            $t->contentRenderer = array($this,"renderTabEdit");

        $t = $tc->addTab("customRenderer");
            $t->header = "Vlastní vykreslení tabu";
            $t->content = "Ahoj, jak se máš Jirko!";
            $t->contentRenderer = array($this,"renderTabCustomRenderer");

        $t = $tc->addTab("help");
            $t->header = "Nápověda";
            $t->contentFactory = array($this,"createTabHelp");

        return $tc;
    }
\---

V třídě TabControl si můžete nastavit, který režim používat (**MODE_LAZY** - načte tab až je potřeba, **MODE_PRELOAD** - přednačte tab, **MODE_NO_AJAX** - vypne ajax, **MODE_RELOAD** - načte tab VŽDY když se na něj klikne). Sortable zapíná podporu pro přeřazování tabů. `jQueryTabsOptions` jsou data, která se předají `jQuery UI Tabs`. Handler component je komponenta ve které máte handlery (například v DataGridu). Jako výchozí `handlerComponent` je nastavený rodič `TabControl`u. `loaderText` je text, který se zobrazí, než se načte tab.

Tab přidáme metodou `addTab(nazev);`. Metoda `addTab()` vrací třídu `Tab`. Ve třídě Tab můžeme nastavit hlavičku, továrnu na obsah tabu `contentFactory` nebo přímo obsah `content`, renderer obsahu `contentRenderer` a důležitou proměnou `hasSnippets`, která funguje stejně jako zavináč v šablonách. Tzn. pokud má objekt v tomto tabu snippet(y), tak ho nastavte na hodnotu `TRUE`, jinak nebude správně fungovat AJAX.

Továrnička na obsah tabu
------------------------

Továrničce se předávají 2 parametry:
/---php
    function createTabEdit($name,Tab $tab){
        $form = new AppForm($tab,$name);
        $form->addText("Neco", "Něco")->addRule(Form::FILLED, "Něco je povinné!");
        $form->addTextArea("Popis", "Popis");
        $form->addSubmit("odeslat", "Odeslat");
        $form->onSubmit[] = array($this,"ulozFormular");
        return $form;
    }
\---
Parametr `$tab` použijte vždy jako rodič komponent v `TabControl`u.

Vlastní renderer obsahu
-----------------------
/---php
    function renderTabEdit(Tab $tab){
        $form = $tab->content;
        $form->render();
        echo "<hr>Tento tab byl vyrenderován vlastním rendererem.";
    }
\---
Jako jediný parametr se předává parametr `$tab`, ze kterého získáme obsah jednoduše pomocí `$tab->content;`. Dále už můžete s obsahem naložit jak se vám zlíbí.

Další užitečné metody
=====================

`$TabControl->select($tabName);`
-----------------------
Přepne `TabControl` na daný tab.

Příklad:

Presenter:
/---php
    function handleJdiNaTab($tab){
        $this["tabs"]->select($tab);
    }
\---

Šablona:
/---code html
    <a href="{link jdiNaTab! datagrid}" class="ajax">Přejdi na DataGrid</a>
\---

Pokud bude stránka s TabControlem na veřejných stránkách, doporučuji použít míto `handleJdiNaTab($tabName)` následující kód:
/---php
    function handleJdiNaTab($tab){
        $this["tabs"]->select($tab);
        if(!$this->isAjax())
            $this->redirect("this");
    }
\---
Poté **bude url odpovídat stavu** a výslednou funkčnost to nijak nezmění.

.[note]
Tato metoda se dá volat i jako `$tab->select()`;

`$TabControl->redraw($tabName);`
-----------------------
Tato metoda se hodí třeba pokud odesíláte formulář a po jeho odeslání přecházíte na jiný tab (pokud zůstáváte na stejném tabu, je tato metoda volána automaticky), ale chcete ještě vymazat hodnoty z předchozího formuláře. Potom to bude vypadat nějak následovně:

/---php
    function ulozFormular(AppForm $form){
        $values = $form->values;
        $this->flashMessage("Data přijatá z formuláře:<br>".Debug::dump($values, TRUE), "info");

        $form->setValues(array(), TRUE); // Empty the form

        // Parent of AppForm is Tab
        $tab = $form->parent;
        // Parent of Tab is TabControl
        $tabControl = $tab->parent;

        $tab->redraw(); // Překresli - vymazali jsme formulář

        // Přepneme uživatele zpět na datagrid
        $tabControl->select("datagrid");
    }
\---

.[note]
Tato metoda se dá volat i jako `$tab->redraw()`;

`$TabControl->render();`
-----------------------
Vykreslí TabControl.

Vlastní zpracování přeřazených tabů
===================================

Použijte proměné $TabControl->saveTabsOrder a $TabControl->loadTabsOrder. Do těhto proměnných můžete umístit callback ve formátu: `array($obj,"nazevMetody");`.

Příklad (nachází se v TabControl.php):
/---php
    /**
     * Saves tabs order to session (default implemetation od TabControl::saveTabsOrder)
     * @param array $order
     */
    function saveTabsOrder(array $order){
        $session = Environment::getSession("TabControl\\".$this->getUniqueId());
        $session["order"] = $order;
    }

    /**
     * Loads tabs order from session (default implemetation od TabControl::loadTabsOrder)
     * @return array
     */
    function loadTabsOrder(){
        $session = Environment::getSession("TabControl\\".$this->getUniqueId());
        return (array)$session["order"];
    }
\---

Při přeřazení tabů, se volá i jedna [událost | http://nette.org/cs/nette-object]. A to `$TabControl->onTabsOrderChange`.

{{tags: nette-0.9}}

{{author: Honza Kuchař|1018}}
